<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gửi Suzy - Lời xin lỗi chân thành từ Huy Hoàng</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #fff5f5 0%, #fed7e2 100%);
            overflow-x: hidden;
        }
        
        .handwriting {
            font-family: 'Dancing Script', cursive;
        }

        /* Floating Hearts Animation */
        .heart {
            position: absolute;
            color: #ff9999;
            opacity: 0;
            animation: float 6s ease-in infinite;
        }

        @keyframes float {
            0% { transform: translateY(100vh) scale(0.5); opacity: 0; }
            20% { opacity: 0.6; }
            100% { transform: translateY(-10vh) scale(1.2); opacity: 0; }
        }

        /* Fade In Animation for Letter */
        .fade-in {
            animation: fadeIn 1.2s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Envelope Open Animation */
        .fade-out {
            animation: fadeOut 0.6s ease-in forwards;
        }

        @keyframes fadeOut {
            to { opacity: 0; transform: scale(1.1); pointer-events: none; }
        }

        /* Confetti Canvas */
        #confetti-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 50;
            touch-action: none;
        }
        
        /* Envelope Bounce */
        .bounce-slight {
            animation: bounce 2.5s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(-3%); }
            50% { transform: translateY(0); }
        }

        .letter-bg {
            background-image: radial-gradient(#f0f0f0 1.5px, transparent 1.5px);
            background-size: 20px 20px;
            background-color: #ffffff;
        }
    </style>
</head>
<body class="min-h-[100dvh] flex items-center justify-center relative overflow-hidden">

    <!-- Background Elements -->
    <div id="hearts-container" class="absolute inset-0 overflow-hidden pointer-events-none z-0"></div>

    <!-- ENVELOPE VIEW (Ban đầu) -->
    <div id="envelope" class="z-20 cursor-pointer group transition-transform duration-300 hover:scale-105 active:scale-95 text-center px-4">
        <div class="relative w-64 h-44 md:w-80 md:h-56 bg-gradient-to-br from-rose-400 to-pink-500 rounded-lg shadow-2xl flex items-center justify-center mx-auto bounce-slight border-4 border-white">
            <!-- Envelope Design -->
            <div class="absolute top-0 left-0 w-full h-full overflow-hidden rounded-lg">
                <div class="absolute -top-[50%] left-[50%] -translate-x-1/2 w-[140%] h-full bg-rose-300 transform rotate-45 border-b-2 border-white opacity-40"></div>
            </div>
            
            <!-- Heart Seal -->
            <div class="w-14 h-14 md:w-16 md:h-16 bg-white rounded-full flex items-center justify-center shadow-lg z-10 text-rose-500 group-hover:scale-110 transition-transform">
                <i data-lucide="mail-open" class="w-7 h-7 md:w-8 md:h-8"></i>
            </div>
            
            <p class="absolute -bottom-10 text-rose-600 font-bold text-sm md:text-base tracking-widest uppercase">
                Chạm để mở thư
            </p>
        </div>
        <div class="mt-14 text-center">
            <h2 class="text-2xl md:text-3xl font-bold text-rose-700 handwriting">Gửi Suzy bé bỏng</h2>
            <p class="text-xs text-rose-400 mt-1 uppercase tracking-tighter">Từ người đang rất hối lỗi - Huy Hoàng</p>
        </div>
    </div>

    <!-- MAIN LETTER CONTENT (Ẩn cho đến khi click) -->
    <div id="main-card" class="container mx-auto px-4 z-10 relative hidden opacity-0 transition-opacity duration-1000">
        <div class="max-w-xl mx-auto letter-bg rounded-2xl shadow-2xl overflow-hidden border border-rose-100 w-full">
            
            <!-- Header -->
            <div class="bg-rose-50 h-24 md:h-32 flex items-center justify-center relative border-b border-rose-100">
                <div class="absolute -bottom-8 bg-white p-2 rounded-full shadow-md">
                    <div class="w-16 h-16 bg-rose-500 rounded-full flex items-center justify-center text-white">
                        <i data-lucide="pen-tool" class="w-8 h-8"></i>
                    </div>
                </div>
            </div>

            <!-- Tâm thư -->
            <div class="pt-12 pb-8 px-6 md:pt-14 md:pb-10 md:px-10 text-center">
                <h1 class="text-2xl md:text-3xl text-gray-800 font-bold mb-1 handwriting">Suzy thương yêu,</h1>
                <p class="text-rose-400 font-semibold mb-6 text-xs uppercase tracking-widest">Huy Hoàng's Apology</p>

                <div class="space-y-4 text-gray-700 text-left leading-relaxed text-sm md:text-base italic">
                    <p>
                        Anh viết những dòng này khi trong lòng vẫn còn cảm giác nặng nề và hối hận vô cùng. Chuyện tối qua anh về trễ... anh biết dù có đưa ra bao nhiêu lý do thì việc để em phải chờ đợi, lo lắng và một mình trong đêm là điều không thể bào chữa được.
                    </p>
                    <p>
                        Lúc đứng trước cửa và nhìn thấy gương mặt em, anh hiểu rằng mình đã vô tâm đến nhường nào. Anh đã không trân trọng thời gian mà chúng ta có, và tệ hơn là đã để những bộn bề bên ngoài làm tổn thương người quan trọng nhất đối với anh.
                    </p>
                    <p>
                        Anh xin lỗi vì đã khiến em buồn, xin lỗi vì đã làm hỏng buổi tối của chúng mình. Anh trân trọng từng phút giây em ở bên cạnh, và từ nay về sau, anh hứa sẽ sắp xếp mọi thứ tốt hơn để không bao giờ để em phải cô đơn chờ đợi như vậy nữa.
                    </p>
                    <p class="font-bold text-center text-rose-600 not-italic border-t border-rose-100 pt-4">
                        "Em là ưu tiên duy nhất, xin hãy tha thứ cho anh nhé?"
                    </p>
                </div>

                <!-- Action Buttons -->
                <div class="mt-8 flex flex-col gap-3 justify-center items-center">
                    <button id="forgiveBtn" class="w-full sm:w-auto px-10 py-4 bg-rose-500 hover:bg-rose-600 text-white font-bold rounded-full shadow-lg transform transition hover:scale-105 active:scale-95 flex items-center justify-center gap-2 text-sm md:text-base touch-manipulation">
                        <i data-lucide="heart" class="w-5 h-5"></i>
                        Em tha lỗi cho anh nha
                    </button>
                    
                    <button id="musicBtn" class="text-xs text-gray-400 hover:text-rose-500 flex items-center gap-2 mt-2 transition-colors py-2 touch-manipulation">
                        <i data-lucide="volume-2" class="w-4 h-4"></i>
                        <span id="musicText">Bật chút nhạc piano nhé?</span>
                    </button>
                </div>
            </div>
            
            <audio id="bgMusic" loop>
                <source src="https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3?filename=piano-moment-111584.mp3" type="audio/mpeg">
            </audio>

        </div>
        
        <p class="text-center text-rose-300 text-[10px] mt-6 tracking-widest uppercase">Sincerely from Huy Hoàng to his only Suzy</p>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 flex items-center justify-center z-50 opacity-0 pointer-events-none transition-opacity duration-500 px-4">
        <div class="absolute inset-0 bg-rose-900 bg-opacity-30 backdrop-blur-sm"></div>
        <div class="bg-white rounded-3xl p-8 w-full max-w-sm mx-auto shadow-2xl transform scale-90 transition-transform duration-300 relative z-10 text-center">
            <div class="w-20 h-20 bg-rose-100 rounded-full flex items-center justify-center mx-auto mb-4 text-rose-500">
                <i data-lucide="party-popper" class="w-10 h-10"></i>
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mb-2 handwriting">Hạnh phúc quá!</h3>
            <p class="text-gray-600 text-sm">Cảm ơn em vì đã rộng lượng với anh. Anh đang chuẩn bị món quà nhỏ chuộc lỗi đây, chờ anh nhé! ❤️</p>
            <button onclick="closeModal()" class="mt-6 w-full py-3 bg-rose-500 text-white font-bold rounded-xl transition touch-manipulation">
                Yêu anh nhất!
            </button>
        </div>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <script>
        lucide.createIcons();

        // --- Logic Mở Thư ---
        const envelope = document.getElementById('envelope');
        const mainCard = document.getElementById('main-card');

        envelope.addEventListener('click', () => {
            envelope.classList.add('fade-out');
            setTimeout(() => {
                envelope.classList.add('hidden');
                mainCard.classList.remove('hidden');
                void mainCard.offsetWidth; 
                mainCard.classList.remove('opacity-0');
                mainCard.classList.add('fade-in');
            }, 500);
        });

        // --- Hiệu ứng Trái tim ---
        const heartsContainer = document.getElementById('hearts-container');
        const colors = ['#fed7e2', '#fbb6ce', '#f687b3', '#fff5f5'];

        function createHeart() {
            const heart = document.createElement('div');
            heart.classList.add('heart');
            heart.innerHTML = '❤'; 
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = Math.random() * 2 + 5 + 's'; 
            heart.style.fontSize = Math.random() * 15 + 10 + 'px';
            heart.style.color = colors[Math.floor(Math.random() * colors.length)];
            heartsContainer.appendChild(heart);
            setTimeout(() => { heart.remove(); }, 6000);
        }
        setInterval(createHeart, 400);

        // --- Logic Nhạc ---
        const musicBtn = document.getElementById('musicBtn');
        const musicText = document.getElementById('musicText');
        const audio = document.getElementById('bgMusic');
        let isPlaying = false;

        musicBtn.addEventListener('click', () => {
            if (isPlaying) {
                audio.pause();
                musicText.innerText = "Bật chút nhạc piano nhé?";
            } else {
                audio.volume = 0.4;
                audio.play().catch(e => console.log("Cần tương tác để phát nhạc"));
                musicText.innerText = "Tắt nhạc";
            }
            isPlaying = !isPlaying;
        });

        // --- Pháo giấy & Tha thứ ---
        const forgiveBtn = document.getElementById('forgiveBtn');
        const modal = document.getElementById('successModal');
        const modalContent = modal.querySelector('div:nth-child(2)');
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let confetti = [];

        initConfetti = () => {
            for (let i = 0; i < 150; i++) {
                confetti.push({
                    color: { front: '#f43f5e', back: '#be123c' },
                    dimensions: { x: Math.random() * 10 + 5, y: Math.random() * 10 + 5 },
                    position: { x: window.innerWidth/2, y: window.innerHeight/2 },
                    rotation: Math.random() * 2 * Math.PI,
                    scale: { x: 1, y: 1 },
                    velocity: { x: (Math.random() - 0.5) * 40, y: (Math.random() - 0.5) * 40 },
                });
            }
        };

        renderConfetti = () => {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            confetti.forEach((confetto, index) => {
                confetto.position.x += confetto.velocity.x;
                confetto.position.y += confetto.velocity.y;
                confetto.velocity.y += 0.5; // trọng lực
                confetto.rotation += 0.1;
                
                ctx.save();
                ctx.translate(confetto.position.x, confetto.position.y);
                ctx.rotate(confetto.rotation);
                ctx.fillStyle = confetto.color.front;
                ctx.fillRect(-confetto.dimensions.x/2, -confetto.dimensions.y/2, confetto.dimensions.x, confetto.dimensions.y);
                ctx.restore();

                if (confetto.position.y > canvas.height) confetti.splice(index, 1);
            });
            if (confetti.length > 0) window.requestAnimationFrame(renderConfetti);
        };

        forgiveBtn.addEventListener('click', () => {
            modal.classList.remove('opacity-0', 'pointer-events-none');
            modalContent.classList.remove('scale-90');
            modalContent.classList.add('scale-100');
            initConfetti();
            renderConfetti();
            forgiveBtn.innerHTML = `<i data-lucide="check" class="w-5 h-5"></i> Đã được tha thứ`;
            lucide.createIcons();
        });

        window.closeModal = function() {
            modal.classList.add('opacity-0', 'pointer-events-none');
            modalContent.classList.remove('scale-100');
            modalContent.classList.add('scale-90');
        }
    </script>
</body>
</html>
